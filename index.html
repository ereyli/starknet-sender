<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Sendwise</title>
  <script src="https://cdn.jsdelivr.net/npm/starknetkit@latest/dist/index.umd.min.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <link id="favicon" rel="icon" type="image/png" href="https://raw.githubusercontent.com/starknet-edu/starknet-logo/main/starknet-logo.png" />
  <style>
    body {
      font-family: 'Inter', sans-serif;
    }
    .glass {
      background: rgba(255, 255, 255, 0.05);
      backdrop-filter: blur(12px);
      border: 1px solid rgba(255, 255, 255, 0.08);
    }
    .fade-in {
      animation: fadeIn 0.8s ease-in-out;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .input-focus:focus {
      outline: none;
      border-color: #7c3aed;
      box-shadow: 0 0 0 2px #a78bfa40;
    }
    .btn-gradient {
      background: linear-gradient(to right, #7c3aed, #4f46e5);
    }
    .btn-gradient:hover {
      background: linear-gradient(to right, #6d28d9, #4338ca);
    }
  </style>
</head>
<body class="bg-gradient-to-br from-gray-950 via-gray-900 to-gray-800 text-white min-h-screen flex flex-col items-center justify-center p-6">
  <div class="w-full max-w-3xl glass rounded-xl shadow-xl p-8 fade-in">
    <div class="flex items-center justify-center mb-6">
      <img id="logo" src="https://raw.githubusercontent.com/starknet-edu/starknet-logo/main/starknet-logo.png" alt="logo" class="h-8 w-8 mr-2">
      <h1 class="text-4xl font-bold text-purple-400">Sendwise</h1>
    </div>
    <p class="text-center text-gray-400 mb-6">Batch send ETH or STRK on Starknet with style ðŸš€</p>

    <div id="wallet-section" class="text-center mb-6">
      <button id="connectBtn" class="btn-gradient transition text-white font-bold py-2 px-6 rounded-full shadow">
        Connect Wallet
      </button>
      <p id="walletAddress" class="mt-2 text-green-400 text-sm"></p>
    </div>

    <div id="form-section" class="space-y-4">
      <div class="flex flex-col sm:flex-row sm:space-x-2 space-y-2 sm:space-y-0">
        <input placeholder="Recipient address" class="flex-1 p-3 bg-gray-800 rounded-lg border border-gray-700 input-focus" />
        <input placeholder="Amount" class="w-28 p-3 bg-gray-800 rounded-lg border border-gray-700 text-center input-focus" type="number" />
        <select class="p-3 bg-gray-800 rounded-lg border border-gray-700 input-focus">
          <option>ETH</option>
          <option>STRK</option>
        </select>
        <div class="flex space-x-2 justify-center">
          <button class="removeBtn text-red-400 text-xl">Ã—</button>
          <button class="addBtn text-green-400 text-xl">+</button>
        </div>
      </div>
    </div>

    <div class="mt-6 text-center text-gray-400">
      <p>Service Fee: <strong>5 STRK</strong> or <strong>0.001 ETH</strong></p>
    </div>

    <div class="mt-6 text-center">
      <button id="sendBtn" disabled class="btn-gradient transition text-white font-bold py-2 px-8 rounded-full shadow">
        Send Transaction
      </button>
    </div>
  </div>

  <script>
    const formSection = document.getElementById('form-section');
    const connectBtn = document.getElementById('connectBtn');
    const walletAddressDisplay = document.getElementById('walletAddress');
    const sendBtn = document.getElementById('sendBtn');

    let wallet = null;

    connectBtn.onclick = async () => {
      const result = await window.starknetkit.connect({
        modalMode: "alwaysAsk",
        webWalletUrl: "https://web.argent.xyz",
        chainId: "SN_SEPOLIA",
      });
      if (result?.wallet?.isConnected && result.wallet.selectedAddress) {
        wallet = result.wallet;
        walletAddressDisplay.textContent = result.wallet.selectedAddress.slice(0, 6) + '...' + result.wallet.selectedAddress.slice(-4);
        sendBtn.disabled = false;
      }
    };

    formSection.addEventListener('click', e => {
      if (e.target.classList.contains('addBtn')) {
        const row = e.target.closest('div').cloneNode(true);
        row.querySelectorAll('input').forEach(i => i.value = '');
        formSection.appendChild(row);
      }
      if (e.target.classList.contains('removeBtn')) {
        const rows = formSection.querySelectorAll('div');
        if (rows.length > 1) {
          e.target.closest('div').remove();
        }
      }
    });

    sendBtn.onclick = () => {
      const rows = formSection.querySelectorAll('div');
      const recipients = [];
      const amounts = [];
      rows.forEach(row => {
        const inputs = row.querySelectorAll('input');
        const address = inputs[0].value;
        const amount = inputs[1].value;
        if (address && amount) {
          recipients.push(address);
          amounts.push(amount);
        }
      });

      alert("Would send to: " + JSON.stringify(recipients) + " with amounts: " + JSON.stringify(amounts));
    };
  </script>
</body>
</html>
